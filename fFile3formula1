
 21. How many drivers participated in 2022 season?

 select count(distinct (driverid)) as tot_drivers
 from driver_standings ds 
 join races r on r.raceid = ds.raceid
 where year =2022
 
 22. How many races has the top 5 constructors won in the last 10 years
 
 with top_five as (
select c.constructorid,c.name,count(1) as tot_win
from constructor_standings cs 
join races r on r.raceid = cs.raceid
join constructors c on c.constructorid =cs.constructorid
where position = 1 --and extract(year from current_date)::int - year <= 10 
group by c.constructorid,c.name
	 order by tot_win desc
	 limit 5)
select cte.constructorid,cte.name,coalesce (x. tot_win,0) as tot_win 
from top_five cte 
left join (select c.constructorid,c.name,count(1) as tot_win
from constructor_standings cs 
join races r on r.raceid = cs.raceid
join constructors c on c.constructorid =cs.constructorid
where position = 1 and extract(year from current_date)::int - year <= 10 
group by c.constructorid,c.name) x on x.constructorid = cte.constructorid

23. Display the winners of every sprint so far in F1

select r.year, r.name, concat(d.forename,' ',d.surname) as driver_name
	from sprint_results sr
	join drivers d on d.driverid=sr.driverid
	join races r on r.raceid=sr.raceid
	where sr.position=1
	order by 1,2;
	
 24. Find the driver who has the most no of Did Not Qualify during the race.

select d.driverid,d.forename||d.surname as driver_name,count(1) as disqualify_count
from status s
join results r on r.statusid = s.statusid
join drivers d on d.driverid = r.driverid
where status= 'Did not qualify'
group by d.driverid
order by disqualify_count desc
limit 1

25. During the last race of 2022 season, identify the drivers who did not finish the race 
and the reason for it.

select d.forename||''||d.surname as driver_name,s.status
from results r 
join drivers d on d.driverid = r.driverid
join races res on res.raceid = r.raceid 
join status s on s.statusid= r.statusid
where res.raceid= (select max(raceid) from races where year = 2022) and s.status!='Finished'
